---
import Layout from '@/layouts/layout.astro';
import { Profile } from '@/components/profile';

import { resolveSource } from '@/lib/profile';

const username = Astro.params.username?.toLowerCase();

if (!username) {
  return Astro.rewrite('/404');
}

const source = await resolveSource(username);

if (!source) {
  return Astro.rewrite('/404');
}
---

<Layout title="Profile">
  <Profile client:load source={source} username={username} />
</Layout>
